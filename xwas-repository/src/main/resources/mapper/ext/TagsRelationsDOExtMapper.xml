<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.xinxin.sass.repository.dao.TagsRelationsDOMapper">
  <resultMap id="BaseResultMapExt" type="cn.com.xinxin.sass.repository.model.TagsRelationsDO">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="tenant_id" jdbcType="VARCHAR" property="tenantId" />
    <result column="tag_id" jdbcType="VARCHAR" property="tagId" />
    <result column="key_id" jdbcType="VARCHAR" property="keyId" />
    <result column="key_name" jdbcType="VARCHAR" property="keyName" />
    <result column="description" jdbcType="VARCHAR" property="description" />
    <result column="gmt_creator" jdbcType="VARCHAR" property="gmtCreator" />
    <result column="gmt_created" jdbcType="TIMESTAMP" property="gmtCreated" />
    <result column="gmt_updater" jdbcType="VARCHAR" property="gmtUpdater" />
    <result column="gmt_updated" jdbcType="TIMESTAMP" property="gmtUpdated" />
    <result column="extension" jdbcType="VARCHAR" property="extension" />
    <result column="deleted" jdbcType="BIT" property="deleted" />
  </resultMap>


  <resultMap id="TagMapDOBaseResultMapExt" type="cn.com.xinxin.sass.repository.model.TagsMapDO">
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="tenant_id" jdbcType="VARCHAR" property="tenantId" />
    <result column="code" jdbcType="VARCHAR" property="code" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="description" jdbcType="VARCHAR" property="description" />
    <result column="key_id" jdbcType="VARCHAR" property="keyId" />
    <result column="key_name" jdbcType="VARCHAR" property="keyName" />
    <result column="gmt_creator" jdbcType="VARCHAR" property="gmtCreator" />
    <result column="gmt_created" jdbcType="TIMESTAMP" property="gmtCreated" />
    <result column="gmt_updater" jdbcType="VARCHAR" property="gmtUpdater" />
    <result column="gmt_updated" jdbcType="TIMESTAMP" property="gmtUpdated" />
    <result column="extension" jdbcType="VARCHAR" property="extension" />
    <result column="deleted" jdbcType="BIT" property="deleted" />
  </resultMap>

  <sql id="Base_Column_List_Ext">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, tenant_id, tag_id, key_id, key_name, description, gmt_creator, gmt_created, gmt_updater,
    gmt_updated, extension, deleted
  </sql>


  <sql id="Tags_Map_Base_Column_List_Ext">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, tenant_id, code, name, description, key_id, key_name, gmt_creator, gmt_created, gmt_updater,
    gmt_updated, extension, deleted
  </sql>



  <delete id="deleteTagsRelationsByTagId"  parameterType="java.lang.Long">

    delete from tags_relations
    where tag_id = #{tagId,jdbcType=BIGINT}
  </delete>


  <select id="selectTagsByKeyId" resultMap="BaseResultMapExt" parameterType="java.lang.String" >
    select
    tg.id,tg.code,tg.name,tg.description, tg.gmt_creator, tg.gmt_created,
    tg.gmt_updater,tg.gmt_updated, tg.extension, tg.deleted
    from tags as tg, tags_relations as tgr
    where tgr.key_id = #{keyId,jdbcType=VARCHAR}
    and tg.id=tgr.tag_id
  </select>


  <select id="selectTagsByKeyIdLists" resultMap="BaseResultMapExt" parameterType="java.lang.String" >
    select
    tg.id,tg.code,tg.name,tg.description, tg.gmt_creator, tg.gmt_created,
    tg.gmt_updater,tg.gmt_updated, tg.extension, tg.deleted
    from tags as tg, tags_relations as tgr
    where tg.id=tgr.tag_id
    and tgr.key_id
    in
    <foreach collection="keyIds" index="index" item="item" open="(" separator="," close=")">
      #{item}
    </foreach>
  </select>


  <select id="selectTagsMapsByKeyIds" resultMap="BaseResultMapExt" parameterType="java.lang.String" >
    select
    tg.id,tg.code,tg.name,tg.description, tgr.key_id, tgr.key_name, tg.gmt_creator, tg.gmt_created,
    tg.gmt_updater,tg.gmt_updated, tg.extension, tg.deleted
    from tags as tg, tags_relations as tgr
    where tg.id=tgr.tag_id
    and tgr.key_id
    in
    <foreach collection="keyIds" index="index" item="item" open="(" separator="," close=")">
      #{item}
    </foreach>
  </select>


  <insert id="batchCreateRelations" parameterType="java.util.List">

    insert into tags_relations (tenant_id, tag_id,key_id, key_name,
    description,gmt_creator, gmt_updater, extension)
    values
    <foreach collection="relationsList" item="item" index="index" separator=",">
      (#{item.tenantId,jdbcType=VARCHAR}, #{item.tagId,jdbcType=VARCHAR},
      #{item.keyId,jdbcType=VARCHAR}, #{item.keyName,jdbcType=VARCHAR}, #{item.description,jdbcType=VARCHAR},
      #{item.gmtCreator,jdbcType=VARCHAR},#{item.gmtUpdater,jdbcType=VARCHAR},
      #{item.extension,jdbcType=VARCHAR}
      )
    </foreach>
  </insert>

</mapper>